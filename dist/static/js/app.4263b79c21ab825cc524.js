webpackJsonp([1],{0:function(e,t){},AMuX:function(e,t){},AsDT:function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgYmFja2dyb3VuZD0iIzFmOWNmNCIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBmaWxsPSJub25lIiBkPSJNMCAwaDI0djI0SDBWMHoiLz48cGF0aCBkPSJNMy40IDIwLjRsMTcuNDUtNy40OGMuODEtLjM1LjgxLTEuNDkgMC0xLjg0TDMuNCAzLjZjLS42Ni0uMjktMS4zOS4yLTEuMzkuOTFMMiA5LjEyYzAgLjUuMzcuOTMuODcuOTlMMTcgMTIgMi44NyAxMy44OGMtLjUuMDctLjg3LjUtLjg3IDFsLjAxIDQuNjFjMCAuNzEuNzMgMS4yIDEuMzkuOTF6Ii8+PC9zdmc+"},NHnr:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s("7+uW"),r={render:function(){var e=this.$createElement;return(this._self._c||e)("router-view")},staticRenderFns:[]};var a=s("VU/8")({name:"App"},r,!1,function(e){s("AMuX")},null,null).exports,i=s("/ocq"),u=s("Xxa5"),o=s.n(u),c=s("exGp"),m=s.n(c),l=s("DmT9"),d=s.n(l),v=s("fzx2"),h={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("form",{staticClass:"username-card",attrs:{action:"",autocomplete:"off"},on:{submit:function(t){return t.preventDefault(),e.tochat(t)}}},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.username,expression:"username"}],attrs:{type:"text",placeholder:"Enter a username"},domProps:{value:e.username},on:{input:function(t){t.target.composing||(e.username=t.target.value)}}}),e._v(" "),s("button",{attrs:{disabled:""===e.username}},[e._v("\n    Enter Chat\n  ")])])},staticRenderFns:[]};var f=s("VU/8")({name:"Home",data:function(){return{username:""}},methods:{tochat:function(){this.$store.dispatch("set_username",this.username),this.$store.dispatch("set_is_home",!1)}}},h,!1,function(e){s("y8UF")},null,null).exports,p=s("NYxO"),_={name:"Chat",components:{"home-component":f},data:function(){return{isConnected:!1,userMessages:[],inputText:"",userId:"",username:"",users:[],socket:null,isActive:!0}},methods:{connectSocket:function(){var e=this;console.log("env: ",Object({NODE_ENV:"production"}).URL),Object({NODE_ENV:"production"}).URL?this.socket=d()("https://vue-chat-online.herokuapp.com"):this.socket=d()("http://localhost:3000");var t={userId:this.userId,username:this.username};this.isConnected=!0,window.onbeforeunload=function(){e.removeUser(t),console.log("users: ",e.users),e.socket.emit("leave",t)},this.socket.emit("joinMain",t),this.socket.on("chatMessage",function(t){console.log("message: ",t),e.userMessages.push(t),e.scrollDown()}),this.socket.on("userDisconnected",function(s){console.log("message disconnect: ",s),e.removeUser(t.userId),e.userMessages.push(s),console.log("users: ",e.users)}),this.socket.on("updateUsers",function(t){console.log("usersUpdate: ",t),e.users=e.formatUsersArray(t)})},sendMessage:function(){if(""!==this.inputText){var e={userId:this.userId,username:this.username,message:this.inputText,server:!1};this.socket.emit("chatMessage",e),this.inputText=""}},getUsername:function(){this.username=this.$store.getters.getUsername},generateUuid:function(){this.userId=v.b.v4(),this.$store.dispatch("set_user_id",this.userId),console.log("userId :",this.userId)},removeUser:function(e){this.users.splice(this.users.findIndex(function(t){return t.userId===e}),1)},scrollDown:function(){var e=this;return m()(o.a.mark(function t(){var s;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:s=document.getElementById("chat"),setTimeout(function(){s.scrollTop=s.scrollHeight},100);case 2:case"end":return e.stop()}},t,e)}))()},isMainUser:function(e){return e.userId===this.userId},formatUsersArray:function(e){var t=this;return e.splice(e.findIndex(function(e){return e.userId===t.userId}),1),e}},computed:Object(p.b)(["isHome"]),watch:{isHome:function(e,t){console.log("Old: "+t+", new: "+e),e||(this.generateUuid(),this.getUsername(),this.connectSocket())}}},g={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"chat"},[e.isHome?s("home-component"):e._e(),e._v(" "),e.isHome?e._e():s("div",{staticClass:"chat-container"},[e._m(0),e._v(" "),s("div",{staticClass:"chat-body"},[s("div",{staticClass:"chatbox-card w-30"},[e._m(1),e._v(" "),e._l(e.users,function(t){return s("div",{key:t.userId,staticClass:"user-row p-20",class:{mainuser:e.isMainUser(t)}},[s("div",{staticClass:"user-icon"}),e._v(" "),s("div",{staticClass:"username"},[e._v(e._s(e._f("capitalize")(t.username)))])])})],2),e._v(" "),s("div",{staticClass:"chatbox-card w-70"},[s("div",{staticClass:"message-container",attrs:{id:"chat"}},e._l(e.userMessages,function(t){return s("div",{key:t.id,staticClass:"msg-holder"},[t.server?s("div",{staticClass:"server-msg"},[e._v("\n              "+e._s(e._f("capitalize")(t.message))+"\n            ")]):e._e(),e._v(" "),t.server||t.userId===e.userId?e._e():s("div",[s("div",{staticClass:"user-left-name"},[e._v("\n                "+e._s(e._f("capitalize")(t.username))+"\n              ")]),e._v(" "),s("div",{staticClass:"user-msg msg-left"},[e._v("\n                "+e._s(t.message)+"\n              ")])]),e._v(" "),t.server||t.userId!==e.userId?e._e():s("div",{staticClass:"user-msg msg-right"},[e._v("\n              "+e._s(t.message)+"\n            ")])])}),0),e._v(" "),s("form",{staticClass:"message-input",attrs:{action:"",autocomplete:"off"},on:{submit:function(t){return t.preventDefault(),e.sendMessage(t)}}},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.inputText,expression:"inputText"}],staticClass:"mr-10 w-85",attrs:{type:"text",name:"message",placeholder:"Digite uma mensagem..."},domProps:{value:e.inputText},on:{input:function(t){t.target.composing||(e.inputText=t.target.value)}}}),e._v(" "),e._m(2)])])])])],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"chat-header"},[t("div",{staticClass:"tab-chat"},[t("div",{staticClass:"tab-txt tab-selected"},[this._v("Global")])]),this._v(" "),t("div",{staticClass:"tab-chat"},[t("div",{staticClass:"tab-txt"},[this._v("Private")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"user-row p-20"},[t("div",{staticClass:"users-txt"},[this._v("Users")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("button",{staticClass:"w-15 send-btn"},[t("img",{attrs:{type:"submit",src:s("AsDT"),alt:""}})])}]};var I=s("VU/8")(_,g,!1,function(e){s("XkJn")},"data-v-66e12215",null).exports;n.a.use(i.a);var M=new i.a({routes:[{path:"/",name:"IListenToSockets",component:I,mode:history}]});n.a.use(p.a);var C=new p.a.Store({state:{user:{userId:null,username:""},isHome:!0},getters:{getUserId:function(e){return e.user.userId},getUsername:function(e){return e.user.username},getIsHome:function(e){return e.isHome}},mutations:{SET_USERNAME:function(e,t){e.user.username=t},SET_USER_ID:function(e,t){e.user.userId=t},SET_IS_HOME:function(e,t){e.isHome=t}},actions:{otherAction:function(e,t){return!0},set_username:function(e,t){e.commit("SET_USERNAME",t)},set_user_id:function(e,t){e.commit("SET_USER_ID",t)},set_is_home:function(e,t){e.commit("SET_IS_HOME",t)}}});n.a.use(v.a),n.a.config.productionTip=!1,n.a.filter("capitalize",function(e){return e?(e=e.toString()).charAt(0).toUpperCase()+e.slice(1):""}),new n.a({el:"#app",router:M,store:C,components:{App:a},template:"<App/>"})},XkJn:function(e,t){},y8UF:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.4263b79c21ab825cc524.js.map